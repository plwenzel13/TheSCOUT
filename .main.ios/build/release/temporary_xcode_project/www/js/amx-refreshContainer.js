(function(){var a=adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_AMX,"refreshContainer");a.prototype.render=function(b,c){var d=document.createElement("div"),e=document.createElement("div");e.id=c+"_pocketWrapper";e.className="amx-refreshContainer-pocketWrapper";d.appendChild(e);var g=document.createElement("div");g.id=c+"_pocket";g.className="amx-refreshContainer-pocket amx-0";g.setAttribute("aria-hidden","true");var h=document.createElement("div");h.id=c+"_icon";h.className=
"amx-refreshContainer-icon";g.appendChild(h);var k=document.createElement("div");k.id=c+"_text";k.className="amx-refreshContainer-text";var m=b.getAttribute("pullText");null!=m&&""!=m&&g.classList.add("amx-hasText");h=b.getAttribute("busyText");if(null==h||""==h)h=m;k.textContent=m;k.setAttribute("data-pulltext",m);g.appendChild(k);k=document.createElement("div");k.id=c+"_subText";k.className="amx-refreshContainer-subText";m=b.getAttribute("subText");null!=m&&""!=m&&(k.textContent=m,g.classList.add("amx-hasSubText"));
g.appendChild(k);e.appendChild(g);e=document.createElement("div");e.id=c+"_content";e.className="amx-refreshContainer-content";d.appendChild(e);for(var k=b.renderDescendants(),m=0,n=k.length;m<n;++m)e.appendChild(k[m]);adf.mf.api.amx.addDragListener(d,{start:a._handleDragStart,drag:a._handleDrag,end:a._handleDragEnd,threshold:5},{id:c,busyText:h,amxNode:b});adf.mf.api.amx.addBubbleEventListener(g,"tap",a._handleReset,c);g=b.getAttribute("refreshDesc");if(null==g||""==g)g=adf.mf.resource.getInfoString("AMXInfoBundle",
"amx_refreshContainer_REFRESH_BUTTON");d.appendChild(a._createRefreshLink(g,c,b));return d};a.prototype.attributeChangeResult=function(b,c,d){switch(c){case "refreshCompleteExpression":case "subText":return adf.mf.api.amx.AmxNodeChangeResult.REFRESH;default:return a.superclass.attributeChangeResult.call(this,b,c,d)}};a.prototype.refresh=function(b,c,d){var e=b.getId(),g=c.hasChanged("refreshCompleteExpression"),h=c.hasChanged("subText");g&&a._handleReset({data:e});h&&(g=document.getElementById(e+
"_subText"),h=b.getAttribute("subText"),g.textContent=h,e=document.getElementById(e+"_pocket"),e.classList.remove("amx-hasSubText"),null!=h&&""!=h&&(g.textContent=h,e.classList.add("amx-hasSubText")));a.superclass.refresh.call(this,b,c,d)};a._createRefreshLink=function(b,c,d){var e=document.createElement("a");e.setAttribute("id",c+"_refresh");e.className="amx-refreshContainer_refresh-link";e.setAttribute("tabindex",0);adf.mf.api.amx.addBubbleEventListener(e,"click",function(a){a.stopPropagation();
a.preventDefault()});e.setAttribute("href","#");adf.mf.api.amx.addBubbleEventListener(e,"click",a._handleRefresh,{id:c,amxNode:d});e.textContent=b;return e};a._handleRefresh=function(b){b=b.data;var c=b.id,d=b.amxNode;b=d.getTag();var e=document.getElementById(c);null!=e&&adf.mf.api.amx.validate(e,function(){if(adf.mf.api.amx.acceptEvent()){var a=new amx.ActionEvent;adf.mf.api.amx.processAmxEvent(d,"action",void 0,void 0,a,function(){var a=d.getAttributeExpression("action",!0,!0);null!=a&&adf.mf.api.amx.doNavigation(a)})}});
b.isAttributeElBound("refreshCompleteExpression")||(adf.mf.environment.profile.mockData?(adf.mf.api.amx.showLoadingIndicator(),adf.mf.api.finishAnyLoading().then(function(){a._handleReset({data:c})}),window.setTimeout(function(){adf.mf.api.amx.hideLoadingIndicator()},1E3)):adf.mf.api.finishAnyLoading().then(function(){a._handleReset({data:c})}))};a._handleReset=function(a){var c=a.data;a=document.getElementById(c+"_pocketWrapper");if(a.classList.contains("amx-dragging")){var d=document.getElementById(c+
"_pocket");d.setAttribute("data-finishedRefresh","true")}else{a.classList.remove("amx-dragging");var e=document.getElementById(c+"_content");e.classList.remove("amx-dragging");d=document.getElementById(c+"_pocket");d.className=d.className.replace(/amx-[0-9]+/,"amx-0");d.setAttribute("data-finishedRefresh","true");c=document.getElementById(c+"_text");c.textContent=c.getAttribute("data-pulltext");a.style.height="0px";adf.shared.impl.animationUtils._setTransformTranslate(e,"0, 0")}};a._handleDragStart=
function(b,c){for(var d=b.srcElement,e=b.data;null!=d&&d!=this;){if(0<d.scrollTop){e.scrolledToTop=!1;return}d=d.parentElement}var g=e.id;a._handleReset({data:g});var d=document.querySelector(".amx-refreshContainer-pocket#"+g+"_pocket"),h=d.offsetHeight;e.consuming=!1;e.startPageY=null;e.scrolledToTop=!0;e.refreshDistance=h;e.restingDistance=0;var k=adf.mf.internal.amx.getComputedStyle(d).bottom,k=isNaN(parseInt(k,10)),m=document.querySelector(".amx-refreshContainer-icon#"+g+"_icon"),g=0,n=m.offsetTop,
m=m.offsetHeight;isNaN(n)||isNaN(m)||(g=k?n+.75*m:h-(n+.25*m));e.distanceWithoutChange=g;d.setAttribute("data-finishedRefresh","false")};a._handleDrag=function(b,c){var d=b.data;if(d.scrolledToTop){var e=d.id,g=this.querySelector(".amx-refreshContainer-pocket#"+e+"_pocket");if(null!=g&&null!=g.getAttribute){var h="true"==g.getAttribute("data-finishedRefresh");if(h||adf.mf.api.amx.acceptEvent()){var k=Math.abs(c.originalAngle);if(60<=k&&120>=k)if(k=d.startPageY,null==k)d.startPageY=c.pageY;else{var k=
c.pageY-k,m=0<k||d.consuming;if(h||m&&c.requestDragLock(this,!1,!0)){b.preventDefault();b.stopPropagation();c.preventDefault=!0;c.stopPropagation=!0;d.consuming=!0;var n=this.querySelector(".amx-refreshContainer-pocketWrapper#"+e+"_pocketWrapper");n.classList.add("amx-dragging");var t=this.querySelector(".amx-refreshContainer-content#"+e+"_content");t.classList.add("amx-dragging");var m=d.refreshDistance,u=Math.max(0,k);n.style.height=u+"px";adf.shared.impl.animationUtils._setTransformTranslate(t,
"0, "+u+"px");n=d.distanceWithoutChange;t=0;h?t=10:k>n&&(t=Math.min(10,Math.max(0,Math.round((k-n)/(m-n)*10))));h||g.classList.contains("amx-10")||(10==t?(g.className=g.className.replace(/amx-[0-9]+/,"amx-10"),d.restingDistance=m,this.querySelector(".amx-refreshContainer-text#"+e+"_text").textContent=d.busyText,a._handleRefresh({data:{id:e,amxNode:d.amxNode}})):(g.className=g.className.replace(/amx-[0-9]+/,"amx-"+t),d.restingDistance=0))}}}else d.consuming=!1}}};a._handleDragEnd=function(b,c){var d=
b.data;if(d.scrolledToTop){var e=d.id,g=this.querySelector(".amx-refreshContainer-pocket#"+e+"_pocket");if(null!=g&&null!=g.getAttribute){var h=g.getAttribute("data-finishedRefresh"),g=this.querySelector(".amx-refreshContainer-pocketWrapper#"+e+"_pocketWrapper"),k=this.querySelector(".amx-refreshContainer-content#"+e+"_content");g.classList.remove("amx-dragging");k.classList.remove("amx-dragging");"false"==h?(d=d.restingDistance,g.style.height=d+"px",adf.shared.impl.animationUtils._setTransformTranslate(k,
"0, "+d+"px")):a._handleReset({data:e})}}}})();