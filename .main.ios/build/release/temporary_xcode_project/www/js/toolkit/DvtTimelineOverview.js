var DvtTimelineOverview=function(a,b,c){this.Init(a,b,c)};DvtObj.createSubclass(DvtTimelineOverview,DvtOverview,"DvtTimelineOverview");DvtTimelineOverview.ENABLED_STATE="_";DvtTimelineOverview.HOVER_STATE="_h";DvtTimelineOverview.SELECTED_STATE="_s";DvtTimelineOverview.ACTIVE_SELECTED_STATE="_as";DvtTimelineOverview.BORDER_STYLE="bs";DvtTimelineOverview.BORDER_COLOR="bc";DvtTimelineOverview.BORDER_WIDTH="bw";DvtTimelineOverview.DURATION_BORDER_STYLE="dbs";
DvtTimelineOverview.DURATION_BORDER_COLOR="dbc";DvtTimelineOverview.DURATION_BORDER_WIDTH="dbw";DvtTimelineOverview.BORDER_OFFSET="bof";DvtTimelineOverview.BORDER_OPACITY="bo";DvtTimelineOverview.GLOW_COLOR="gc";DvtTimelineOverview.GLOW_OPACITY="go";DvtTimelineOverview.FILL_COLOR="fc";
DvtTimelineOverview.prototype.Init=function(a,b,c){DvtTimelineOverview.superclass.Init.call(this,a,b,c);a=[DvtColorUtils.getPound(DvtColorUtils.getPastel("#aadd77",.35)),"#aadd77",DvtColorUtils.getPound(DvtColorUtils.getDarker("#aadd77",.5))];DvtTimeUtils.supportsTouch()&&(a=["#aadd77"]);this._defColors=a;this._markerBorderFill=DvtSolidFill.invisibleFill();this._markerSize=12};DvtTimelineOverview.prototype.getParser=function(a){return new DvtTimelineOverviewParser(this)};
DvtTimelineOverview.prototype._applyParsedProperties=function(a){DvtTimelineOverview.superclass._applyParsedProperties.call(this,a);this._selectionMode=a.selectionMode;this._markers=a.markers;this._seriesIds=a.seriesIds;this._defaultMarkerStyles=a.defaultMarkerStyles;this._durationColors="#267DB3 #68C182 #FAD55C #ED6647 #8561C8 #6DDBDB #FFB54D #E371B2 #47BDEF #A2BF39 #A75DBA #F7F37B".split(" ");a.labelStyle&&(this._labelStyle=new DvtCSSStyle(a.labelStyle));a="solid"==this.getStyle(DvtTimelineOverview.ENABLED_STATE,
DvtTimelineOverview.BORDER_STYLE)?parseInt(this.getStyle(DvtTimelineOverview.ENABLED_STATE,DvtTimelineOverview.BORDER_OFFSET),10):1;var b="solid"==this.getStyle(DvtTimelineOverview.ACTIVE_SELECTED_STATE,DvtTimelineOverview.BORDER_STYLE)?parseInt(this.getStyle(DvtTimelineOverview.ACTIVE_SELECTED_STATE,DvtTimelineOverview.BORDER_OFFSET),10):1,c="solid"==this.getStyle(DvtTimelineOverview.SELECTED_STATE,DvtTimelineOverview.BORDER_STYLE)?parseInt(this.getStyle(DvtTimelineOverview.SELECTED_STATE,DvtTimelineOverview.BORDER_OFFSET),
10):1;this.isItemSelectionEnabled()?this._markerSpacingOffset=Math.max(b,c,a,1)/2+1:this._markerSpacingOffset=1;this._defOpacity=this.isVertical()?0:.75;this._defAlphas=[this._defOpacity,this._defOpacity,this._defOpacity];this._radialFill=new DvtLinearGradientFill(250,this._defColors,this._defAlphas);this._linearFill=new DvtLinearGradientFill(180,this._defColors,this._defAlphas);a=this.isVertical()?0:1;this._border=new DvtSolidStroke("#aadd77",a)};
DvtTimelineOverview.prototype.getSeriesIds=function(){return null==this._seriesIds?null:this._seriesIds.split(" ")};DvtTimelineOverview.prototype.addLabel=function(a,b,c,d,e,g){DvtTimelineOverview.superclass.addLabel.call(this,a,b,c,d,e,g,this._labelStyle)};DvtTimelineOverview.prototype.isItemSelectionEnabled=function(){return"none"!=this._selectionMode};
DvtTimelineOverview.prototype.getDrawableById=function(a){var b="_mrk_"+a;a="_drn_"+a;for(var c=this.getNumChildren(),d=0;d<c;d++){var e=this.getChildAt(d);if(null!=e&&(b==e.getId()||a==e.getId()))return e}return null};DvtTimelineOverview.prototype.getItemId=function(a){return a.getId().substr(5)};DvtTimelineOverview.prototype.getStyle=function(a,b){return this._borderStyles[a+b]};DvtTimelineOverview.prototype.getX=function(a){return null!=a._node?a._node.getX():a.getMatrix().getTx()};
DvtTimelineOverview.prototype.getY=function(a){return null!=a._node?a._node.getY():a.getMatrix().getTy()};DvtTimelineOverview.prototype.getScaleX=function(a){a=a.getScaleX();null==a&&(a=this.isVertical()?(this.Width-this.getTimeAxisWidth()-4)/2:1);return a};DvtTimelineOverview.prototype.getScaleY=function(a){a=a.getScaleY();null==a&&(a=1);return a};
DvtTimelineOverview.prototype.parseDataXML=function(a,b){DvtTimelineOverview.superclass.parseDataXML.call(this,a,b);if(null!=this._markers){for(var c=this.calculateOptimalSize(this._start,this._end,a,b,this._markerSize),d=[],e=0;e<this._markers.length;e++){var g=this._markers[e];null==g._endTime?this.addMarker(g,c):d[d.length]=g}this.prepareDurations(d);this.addDurations(d);this._markerSize=c}};
DvtTimelineOverview.prototype.prepareDurations=function(a){this._maxDurationY=0;var b=null;null==this._durationColorMap&&(this._durationColorMap={});for(var c=0;c<a.length;c++){var d=a[c],e=d.getId(),g=e.substring(e.indexOf(":")+1,e.length),g=g.substring(0,g.indexOf(":"));g!=b&&(this._colorCount=0,b=g);d._durationLevel=this.calculateDurationY(d,a);null==d._durationFillColor&&(null==this._durationColorMap[e]?(this._durationColorMap[e]=this._colorCount,d._durationFillColor=this._durationColors[this._colorCount],
this._colorCount++,this._colorCount==this._durationColors.length&&(this._colorCount=0)):d._durationFillColor=this._durationColors[this._durationColorMap[e]])}};DvtTimelineOverview.prototype.getDurationColorMap=function(){return this._durationColorMap?this._durationColorMap:null};
DvtTimelineOverview.prototype.calculateOptimalSize=function(a,b,c,d,e){for(var g={max:1,arr:[]},h=this.isVertical()?d:c,k=0;k<this._markers.length;k++){var m=this._markers[k];if(null!=m._endTime){var n=DvtTimeUtils.getDatePosition(a,b,m.getTime(),h);this.isHorizontalRTL()&&(n=h-n);m.setX(n)}else if(this.calculateSize(m,a,b,h,e/2,g,d),g.max>d)break}return g.max>d&&1<e?this.calculateOptimalSize(a,b,c,d,e-1):e};
DvtTimelineOverview.prototype.addMarker=function(a,b){var c="_mrk_"+a.getId(),d=a.getColor(),e=a.isGradient(),g=a.getOpacity();null==g&&(g=this._defOpacity,0==g&&null!=d&&(g=1));var h=this.getScaleX(a),k=this.getScaleY(a),m=a.getShape();if(this.isVertical())var m=DvtSimpleMarker.RECTANGLE,h=2*h,k=2*k,n=a.getY()+h/2,t=a.getX()+k/2;else h*=b,k*=b,n=a.getX()+h/2,t=a.getY()+k/2;c=new DvtSimpleMarker(this.getCtx(),m,null,n,t,h,k,null,c);c._node=a;null==d&&g==this._defOpacity&&null==e?(e=m==DvtSimpleMarker.CIRCLE?
this._radialFill:this._linearFill,d=this._border):(h=this._defColors,null!=d&&(DvtTimeUtils.supportsTouch()?h=[d]:(h=DvtColorUtils.getPastel(d,.5),k=DvtColorUtils.getDarker(d,.5),h=[h,d,k])),k=[g,g,g],e=null==e?m==DvtSimpleMarker.CIRCLE?new DvtLinearGradientFill(250,h,k):new DvtLinearGradientFill(180,h,k):new DvtSolidFill(d,k[0]),d=new DvtSolidStroke(d,g));c.setFill(e);c.setStroke(d);this.isItemSelectionEnabled()&&c.setSelectable(!0);d=this.getNumChildren();g=this.getChildAt(d-1);d>this._lastChildIndex&&
("tb"==g.getId()||"arr"==g.getId())?this.addChildAt(c,d-this._lastChildIndex):this.addChild(c);a.setDisplayable(c);this.applyState(c,DvtTimelineOverview.ENABLED_STATE);!this.isVertical()&&m!=DvtSimpleMarker.RECTANGLE&&m!=DvtSimpleMarker.DIAMOND&&m!=DvtSimpleMarker.TRIANGLE_UP&&m!=DvtSimpleMarker.TRIANGLE_DOWN&&m!=DvtSimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||c.setPixelHinting(!0);return c};
DvtTimelineOverview.prototype.addDurations=function(a){for(var b=this.getCtx(),c=this._maxDurationY;0<c;c--)for(var d=0;d<a.length;d++){var e=a[d];if(c==e._durationLevel){var g=DvtTimeUtils.getDatePosition(this._start,this._end,e.getTime(),this.isVertical()?this.Height:this.Width),h="_drn_"+e.getId(),k=9+5*e._durationLevel,m=DvtTimeUtils.getDatePosition(this._start,this._end,e.getEndTime(),this.isVertical()?this.Height:this.Width),g=this.isVertical()?this.isRTL()?new DvtRect(b,0,g,k,m-g,h):new DvtRect(b,
this.Width-k,g,k,m-g,h):this.isRTL()?new DvtRect(b,this.Width-m,this.Height-k-20,m-g,k,h):new DvtRect(b,g,this.Height-k-20,m-g,k,h);g.setFill(new DvtSolidFill(e._durationFillColor));h=new DvtSolidStroke(this.getStyle(DvtTimelineOverview.ENABLED_STATE,DvtTimelineOverview.DURATION_BORDER_COLOR),1,1);g.setStroke(h);g.setPixelHinting(!0);g._node=e;this.addChild(g);e._durationBar=g;e._durationY=k-2}}this.removeChild(this._timeAxisTopBar);this.addChild(this._timeAxisTopBar)};
DvtTimelineOverview.prototype.calculateSize=function(a,b,c,d,e,g,h){var k=e*this.getScaleX(a)+this._markerSpacingOffset,m=e*this.getScaleY(a)+this._markerSpacingOffset,n=a.getTime();a.isGradient();b=DvtTimeUtils.getDatePosition(b,c,n,d);this.isHorizontalRTL()&&(b=d-b-2*k);if(this.isVertical())e=0,"solid"==this.getStyle(DvtTimelineOverview.ENABLED_STATE,DvtTimelineOverview.BORDER_STYLE)&&(e=parseInt(this.getStyle(DvtTimelineOverview.ENABLED_STATE,DvtTimelineOverview.BORDER_WIDTH),10)),d=this.isRTL()?
e+4:this.Width-2*this.getScaleX(a)-e-4;else{d=3;var t=0;for(c=0;1>c;)n=this.calculateY(g,a.getShape(),b,d,k,m,t,e,h),n.cy==d&&(c=1),t=n.maxy,d=n.cy,c++}a.setX(b);a.setY(d);g.arr.push(a);t>g.max&&(g.max=t)};
DvtTimelineOverview.prototype.calculateY=function(a,b,c,d,e,g,h,k,m){this.isOverviewAbove()&&(d+=this.getTimeAxisHeight());for(var n=0;n<a.arr.length;n++){var t=a.arr[n],u=t.getX(),v=t.getY(),w=t.getShape(),x=this.getScaleX(t),t=this.getScaleY(t),y=Math.abs(c-u),z=k*x+this._markerSpacingOffset+e;if(!(y>=z)&&(u=Math.abs(d-v),w=b==DvtSimpleMarker.CIRCLE&&w==DvtSimpleMarker.CIRCLE&&e==g&&x==t?Math.sqrt(z*z-y*y):k*t+this._markerSpacingOffset+g,w>u&&(d=v+w,h=Math.max(h,d+w),1<=k&&void 0!=m&&h>m)))break}return{cy:d,
maxy:h}};DvtTimelineOverview.prototype.calculateDurationY=function(a,b){var c=b.length,d=a.getTime(),e=a._durationLevel;null==e&&(e=1);for(var g=0;g<c;g++){var h=b[g];if(h!=a){var k=h.getEndTime();if(null!=k){var m=h.getTime(),h=h._durationLevel;null==h&&(h=1);d>=m&&d<=k&&e==h&&(e=h+1,a._durationLevel=e,e=this.calculateDurationY(a,b))}}}e>this._maxDurationY&&(this._maxDurationY=e);return e};
DvtTimelineOverview.prototype.HandleShapeMouseOver=function(a){var b=DvtTimelineOverview.superclass.HandleShapeMouseOver.call(this,a);if(null!=b){if(null!=b._node){var c=b._node.getDescription();null!=c&&this.getCtx().getTooltipManager().showDatatip(a.pageX,a.pageY,c,"#000000");this.isFlashEnvironment()&&this.setCursor("pointer")}if(this.isItemSelectionEnabled()){a=!1;if(null!=this._selectedMarkers)for(c=0;c<this._selectedMarkers.length;c++)if(b==this._selectedMarkers[c]){a=!0;break}a||(a=this.getItemId(b),
c=new DvtTimelineOverviewEvent(DvtTimelineOverviewEvent.SUBTYPE_HIGHLIGHT),c.setItemId(a),this.dispatchEvent(c),this.highlightMarker(b))}}};
DvtTimelineOverview.prototype.HandleShapeMouseOut=function(a){a=DvtTimelineOverview.superclass.HandleShapeMouseOut.call(this,a);if(null!=a&&!this.isMovable(a)){this.getCtx().getTooltipManager().hideTooltip();var b=!1;if(null!=this._selectedMarkers)for(var c=0;c<this._selectedMarkers.length;c++)if(a==this._selectedMarkers[c]){b=!0;break}b||(b=this.getItemId(a),c=new DvtTimelineOverviewEvent(DvtTimelineOverviewEvent.SUBTYPE_UNHIGHLIGHT),c.setItemId(b),this.dispatchEvent(c),this.unhighlightMarker(a))}};
DvtTimelineOverview.prototype.HandleShapeClick=function(a,b,c){b=DvtTimelineOverview.superclass.HandleShapeClick.call(this,a,b,c);null!=b&&this.HandleMarkerClick(b,a.ctrlKey||a.shiftKey||DvtAgent.isTouchDevice())};
DvtTimelineOverview.prototype.HandleMarkerClick=function(a,b){if(this.isItemSelectionEnabled()){this.selectItem(a,b);var c=a._node.getTime();if(null!=c){var d=new DvtTimelineOverviewEvent(DvtTimelineOverviewEvent.SUBTYPE_SCROLL_TIME);d.setTime(c);this.dispatchEvent(d);c=this.getSlidingWindow();c=this.isVertical()?this.getX(a)-c.getHeight()/2:this.getX(a)-c.getWidth()/2;this.animateSlidingWindow(c)}}};
DvtTimelineOverview.prototype.updateSlidingWindowForZoom=function(a,b,c,d){this._start=b;this._end=c;this._width=d;this._renderStart=a;var e=this.isVertical()?this.Height:this.Width,g=DvtTimeUtils.getPositionDate(b,c,0,d);d=DvtTimeUtils.getPositionDate(b,c,e,d);g=DvtTimeUtils.getDatePosition(b,c,g,e);d=DvtTimeUtils.getDatePosition(b,c,d,e);a=DvtTimeUtils.getDatePosition(b,c,a,e);b=Math.max(DvtOverview.MIN_WINDOW_SIZE,Math.min(e,d-g));a+b>e&&(a=Math.max(0,e-b));this.isHorizontalRTL()&&(a=e-b-a);this.animateSlidingWindow(a,
b);this._increment=this.calculateIncrement(e)};DvtTimelineOverview.prototype.highlightItem=function(a){a=this.getDrawableById(a);null!=a&&this.highlightMarker(a)};DvtTimelineOverview.prototype.unhighlightItem=function(a){a=this.getDrawableById(a);null!=a&&this.unhighlightMarker(a)};DvtTimelineOverview.prototype.highlightMarker=function(a){if(null!=this._selectedMarkers)for(var b=0;b<this._selectedMarkers.length;b++)if(a==this._selectedMarkers[b])return;this.applyState(a,DvtTimelineOverview.HOVER_STATE)};
DvtTimelineOverview.prototype.unhighlightMarker=function(a){if(null!=this._selectedMarkers)for(var b=0;b<this._selectedMarkers.length;b++)if(a==this._selectedMarkers[b])return;this.applyState(a,DvtTimelineOverview.ENABLED_STATE)};DvtTimelineOverview.prototype.selSelectItem=function(a){a=this.getDrawableById(a);null!=a&&this.addSelectedMarker(a)};DvtTimelineOverview.prototype.selUnselectItem=function(a){a=this.getDrawableById(a);null!=a&&this.removeSelectedMarker(a)};
DvtTimelineOverview.prototype.selectItem=function(a,b){var c=this.getItemId(a),d=new DvtTimelineOverviewEvent(DvtTimelineOverviewEvent.SUBTYPE_SELECTION);d.setItemId(c);d.setMultiSelect(b);this.dispatchEvent(d)};
DvtTimelineOverview.prototype.addSelectedMarker=function(a){null==this._selectedMarkers&&(this._selectedMarkers=[]);var b=null;0<this._selectedMarkers.length&&(b=this._selectedMarkers[this._selectedMarkers.length-1]);this._selectedMarkers.push(a);null!=b&&this.applyState(b,DvtTimelineOverview.SELECTED_STATE);this.applyState(a,DvtTimelineOverview.ACTIVE_SELECTED_STATE)};
DvtTimelineOverview.prototype.removeSelectedMarker=function(a){if(null!=this._selectedMarkers){for(var b=-1,c=0;c<this._selectedMarkers.length;c++)if(a==this._selectedMarkers[c]){b=c;break}-1!=b&&(this.applyState(a,DvtTimelineOverview.ENABLED_STATE),this._selectedMarkers.splice(b,1))}};
DvtTimelineOverview.prototype.removeAllSelectedMarkers=function(){if(null!=this._selectedMarkers){for(var a=0;a<this._selectedMarkers.length;a++)this.applyState(this._selectedMarkers[a],DvtTimelineOverview.ENABLED_STATE);delete this._selectedMarkers;this._selectedMarkers=null}};
DvtTimelineOverview.prototype.applyState=function(a,b){if(a instanceof DvtSimpleMarker){var c=!1,d=!1;if("solid"==this.getStyle(b,DvtTimelineOverview.BORDER_STYLE)){var c=!0,e=this.getStyle(b,DvtTimelineOverview.BORDER_COLOR);null==e&&(e="#000000");var g=this.getStyle(b,DvtTimelineOverview.GLOW_COLOR);null!=g&&"none"!=g&&(d=!0)}var h=a._borderMarker,k=a._glowMarker;c||null==h?d||null==k||(this.removeChild(k),a._glowMarker=null):(this.removeChild(h),a._borderMarker=null,null!=k&&(this.removeChild(k),
a._glowMarker=null));var m=a.getType();if(c){var c=parseInt(this.getStyle(b,DvtTimelineOverview.BORDER_WIDTH),10),n=parseInt(this.getStyle(b,DvtTimelineOverview.BORDER_OFFSET),10);if(null==h){if(m==DvtSimpleMarker.CIRCLE){this.isFlashEnvironment()&&(n=0);var t=(a.getDimensions().w+2*n)*a.getScaleX(),u=(a.getDimensions().h+2*n)*a.getScaleY(),v=this.getX(a)-n+t/2,w=this.getY(a)-n+u/2}else this.isVertical()?(t=(a.getDimensions().w+(c+1))*a.getScaleX(),u=(a.getDimensions().h+(c+1))*a.getScaleY(),v=this.getY(a)-
(c+1)/2+t/2,w=this.getX(a)-(c+1)/2+u/2):(t=(a.getDimensions().w+2*n)*a.getScaleX(),u=(a.getDimensions().h+2*n)*a.getScaleY(),v=this.getX(a)-n+t/2,w=this.getY(a)-n+u/2);h=new DvtSimpleMarker(this.getCtx(),m,null,v,w,t,u,null,a.getId()+"_border");this.addChildAt(h,this.getChildIndex(a));a._borderMarker=h;h.setFill(this._markerBorderFill)}e=new DvtSolidStroke(e,this.getStyle(b,DvtTimelineOverview.BORDER_OPACITY),c);h.setStroke(e);!this.isVertical()&&m!=DvtSimpleMarker.RECTANGLE&&m!=DvtSimpleMarker.DIAMOND&&
m!=DvtSimpleMarker.TRIANGLE_UP&&m!=DvtSimpleMarker.TRIANGLE_DOWN&&m!=DvtSimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||h.setPixelHinting(!0);d&&(null==k&&(k=n-c,m==DvtSimpleMarker.CIRCLE?(this.isFlashEnvironment()&&(k=0),t=(a.getDimensions().w+2*k)*a.getScaleX(),u=(a.getDimensions().h+2*k)*a.getScaleY(),v=this.getX(a)-k+t/2,w=this.getY(a)-k+u/2):this.isVertical()?(t=(a.getDimensions().w+3)*a.getScaleX(),u=(a.getDimensions().h+3)*a.getScaleY(),v=this.getY(a)+t/2,w=this.getX(a)-
1+u/2):(t=(a.getDimensions().w+2*k)*a.getScaleX(),u=(a.getDimensions().h+2*k)*a.getScaleY(),v=this.getX(a)-k+t/2,w=this.getY(a)-k+u/2),k=new DvtSimpleMarker(this.getCtx(),m,null,v,w,t,u,null,a.getId()+"_glow"),this.addChildAt(k,this.getChildIndex(h)),a._glowMarker=k,k.setFill(this._markerBorderFill)),g=new DvtSolidStroke(g,this.getStyle(b,DvtTimelineOverview.GLOW_OPACITY),4),k.setStroke(g),!this.isVertical()&&m!=DvtSimpleMarker.RECTANGLE&&m!=DvtSimpleMarker.DIAMOND&&m!=DvtSimpleMarker.TRIANGLE_UP&&
m!=DvtSimpleMarker.TRIANGLE_DOWN&&m!=DvtSimpleMarker.PLUS||"false"==this._defaultMarkerStyles.pixelHinting||k.setPixelHinting(!0))}}else(m=a.getId())&&"_drn_"==m.substring(0,5)&&this.applyDurationState(a,b)};DvtTimelineOverview.prototype.applyDurationState=function(a,b){var c=this.getStyle(b,DvtTimelineOverview.DURATION_BORDER_COLOR);null==c&&(c="#000000");var d=parseInt(this.getStyle(b,DvtTimelineOverview.DURATION_BORDER_WIDTH),10);a.setStroke(new DvtSolidStroke(c,1,d))};
DvtTimelineOverview.prototype.orderInsert=function(a){if(0==this._markers.length)this._markers.push(a);else for(var b=this._markers.length-1;0<=b;b--){var c=this._markers[b];if(a.getTime()>c.getTime()){this._markers.splice(b+1,0,a);break}0==b&&this._markers.splice(0,0,a)}};
DvtTimelineOverview.prototype.handleAutoPPRInsert=function(a){a=(new DvtTimelineOverviewParser(this)).parseMarker(a);this.orderInsert(a);var b=this.calculateOptimalSize(this._start,this._end,this.Width,this.Height,this._markerSize);null==a._endTime?this.addMarker(a,b):(b=[],b[0]=a,this.prepareDurations(b),this.addDurations(b))};DvtTimelineOverview.prototype.handleAutoPPRDelete=function(a){this.removeMarker(a)};
DvtTimelineOverview.prototype.handleAutoPPRUpdate=function(a,b){var c=this.findMarkerByRowKey(a);if(null!=c){var c=c.marker,d=c.getId(),d=this.getDrawableById(d),d=this.isMarkerSelected(d);this.removeMarker(a);var e=(new DvtTimelineOverviewParser(this)).parseMarker(b);this.orderInsert(e);var g=this.calculateOptimalSize(this._start,this._end,this.Width,this.Height,this._markerSize);null==e._endTime?(c=this.addMarker(e,g),d&&this.addSelectedMarker(c)):(d=[],d[0]=c,this.prepareDurations(d),this.addDurations(d))}};
DvtTimelineOverview.prototype.findMarkerByRowKey=function(a){for(var b=0;b<this._markers.length;b++){var c=this._markers[b];if(c.getRowKey()==a)return{index:b,marker:c}}return null};
DvtTimelineOverview.prototype.removeMarker=function(a){a=this.findMarkerByRowKey(a);if(null!=a){var b=a.marker;null!=b.getDisplayable()?b=b.getDisplayable():(b=b.getId(),b=this.getDrawableById(b));null!=b&&(this.removeSelectedMarker(b),this.removeChild(b),this._markers.splice(a.index,1),a=b._borderMarker,null!=a&&this.removeChild(a),a=b._glowMarker,null!=a&&this.removeChild(a))}return null};
DvtTimelineOverview.prototype.isMarkerSelected=function(a){if(null!=this._selectedMarkers)for(var b=0;b<this._selectedMarkers.length;b++)if(a==this._selectedMarkers[b])return!0;return!1};DvtTimelineOverview.prototype.getAutomation=function(){this._Automation||(this._Automation=new DvtTimelineOverviewAutomation(this));return this._Automation};DvtTimelineOverview.prototype.getMarkers=function(){return this._markers};var DvtTimelineOverviewParser=function(a){this.Init(a)};
DvtObj.createSubclass(DvtTimelineOverviewParser,DvtObj,"DvtTimelineOverviewParser");DvtTimelineOverviewParser.prototype.Init=function(a){this._view=a;this._parser=new DvtXmlParser(a.getCtx())};DvtTimelineOverviewParser.prototype.parse=function(a){var b=this._parser.parse(a);a=this.ParseRootAttributes(b);b=b.getChildNodes();a.timeAxisInfo=this._parseTimeAxis(b[0]);a.markers=this._parseDataNode(b[1],a.defaultMarkerStyles);2<b.length&&(a.formattedTimeRanges=this._parseFormattedTimeRanges(b[2]));return a};
DvtTimelineOverviewParser.prototype.parseMarker=function(a){a=this._parser.parse(a);a=this.ParseNodeAttributes(a,this._view._defaultMarkerStyles);return new DvtTimelineOverviewNode(this._view,a)};
DvtTimelineOverviewParser.prototype.ParseRootAttributes=function(a){var b={};b.start=parseInt(a.getAttr("start"));b.end=parseInt(a.getAttr("end"));b.width=parseInt(a.getAttr("width"));b.renderStart=parseInt(a.getAttr("renstart"));b.currentTime=parseInt(a.getAttr("ocd"));b.orientation=a.getAttr("orn");b.overviewPosition=a.getAttr("ovp");b.selectionMode=a.getAttr("selmode");b.isRtl=a.getAttr("rtl");b.borderTopStyle=a.getAttr("_bts");b.borderTopColor=a.getAttr("_btc");b.seriesIds=a.getAttr("sid");b.animationOnClick=
a.getAttr("_aoc");var c={};c.shape=a.getAttr("_ds");c.scaleX=a.getAttr("_dsx");c.scaleY=a.getAttr("_dsy");c.opacity=a.getAttr("_do");c.color=a.getAttr("_fc");c.pixelHinting=a.getAttr("_ph");b.defaultMarkerStyles=c;b.handleFillColor=a.getAttr("_hfc");b.handleTextureColor=a.getAttr("_htc");b.handleBackgroundImage=a.getAttr("_hbi");b.handleWidth=a.getAttr("_hw");b.handleHeight=a.getAttr("_hh");b.windowBackgroundColor=a.getAttr("_wbc");b.windowBorderTopStyle=a.getAttr("_wbts");b.windowBorderRightStyle=
a.getAttr("_wbrs");b.windowBorderBottomStyle=a.getAttr("_wbbs");b.windowBorderLeftStyle=a.getAttr("_wbls");b.windowBorderTopColor=a.getAttr("_wbtc");b.windowBorderRightColor=a.getAttr("_wbrc");b.windowBorderBottomColor=a.getAttr("_wbbc");b.windowBorderLeftColor=a.getAttr("_wblc");b.overviewBackgroundColor=a.getAttr("_obc");b.currentTimeIndicatorColor=a.getAttr("_ctic");b.timeIndicatorColor=a.getAttr("_tic");b.timeAxisBarColor=a.getAttr("_tabc");b.timeAxisBarOpacity=a.getAttr("_tabo");b.labelStyle=
a.getAttr("_ls");c={};c._bs=a.getAttr("_bs");c._bc=a.getAttr("_bc");c._bw=a.getAttr("_bw");c._bof=a.getAttr("_bof");c._bo=a.getAttr("_bo");c._gc=a.getAttr("_gc");c._go=a.getAttr("_go");c._dbs=a.getAttr("_dbs");c._dbc=a.getAttr("_dbc");c._dbw=a.getAttr("_dbw");c._hbs=a.getAttr("_hbs");c._hbc=a.getAttr("_hbc");c._hbw=a.getAttr("_hbw");c._hbof=a.getAttr("_hbof");c._hbo=a.getAttr("_hbo");c._hgc=a.getAttr("_hgc");c._hgo=a.getAttr("_hgo");c._hdbs=a.getAttr("_hdbs");c._hdbc=a.getAttr("_hdbc");c._hdbw=a.getAttr("_hdbw");
c._sbs=a.getAttr("_sbs");c._sbc=a.getAttr("_sbc");c._sbw=a.getAttr("_sbw");c._sbof=a.getAttr("_sbof");c._sbo=a.getAttr("_sbo");c._sgc=a.getAttr("_sgc");c._sgo=a.getAttr("_sgo");c._sdbs=a.getAttr("_sdbs");c._sdbc=a.getAttr("_sdbc");c._sdbw=a.getAttr("_sdbw");c._asbs=a.getAttr("_asbs");c._asbc=a.getAttr("_asbc");c._asbw=a.getAttr("_asbw");c._asbof=a.getAttr("_asbof");c._asbo=a.getAttr("_asbo");c._asgc=a.getAttr("_asgc");c._asgo=a.getAttr("_asgo");c._asdbs=a.getAttr("_asdbs");c._asdbc=a.getAttr("_asdbc");
c._asdbw=a.getAttr("_asdbw");b.borderStyles=c;return b};DvtTimelineOverviewParser.prototype._parseDataNode=function(a,b){if(!a)return null;for(var c=[],d=a.getChildNodes(),e=0;e<d.length;e++){var g=this.ParseNodeAttributes(d[e],b),g=new DvtTimelineOverviewNode(this._view,g);c.push(g)}return c};
DvtTimelineOverviewParser.prototype.ParseNodeAttributes=function(a,b){var c={},d="true"==a.getAttr("_sd");c.id=a.getAttr("tid");c.rowKey=a.getAttr("rk");c.time=a.getAttr("t");c.endTime=a.getAttr("et");c.shape=a.getAttr("s");d&&null==c.shape&&(c.shape=b.shape);c.desc=a.getAttr("d");c.color=a.getAttr("c");c.durationFillColor=a.getAttr("dfc");d&&null==c.color&&(c.color=b.color);c.scaleX=a.getAttr("sx");d&&null==c.scaleX&&(c.scaleX=b.scaleX);c.scaleY=a.getAttr("sy");d&&null==c.scaleY&&(c.scaleY=b.scaleY);
c.gradient=a.getAttr("g");c.opacity=a.getAttr("o");d&&null==c.opacity&&(c.opacity=b.opacity);return c};DvtTimelineOverviewParser.prototype._parseTimeAxis=function(a){if(!a)return null;var b={};b.width=a.getAttr("width");b.height=a.getAttr("height");b.ticks=a.getChildNodes();return b};DvtTimelineOverviewParser.prototype._parseFormattedTimeRanges=function(a){return a?a.getChildNodes():null};var DvtTimelineOverviewNode=function(a,b){this.Init(a,b)};
DvtObj.createSubclass(DvtTimelineOverviewNode,DvtObj,"DvtTimelineOverviewNode");
DvtTimelineOverviewNode.prototype.Init=function(a,b){this._view=a;this._rowKey=b.rowKey;this._id=b.id;this._time=parseInt(b.time);this._endTime=null==b.endTime?null:parseInt(b.endTime);this._shape=DvtSimpleMarker.CIRCLE;"square"==b.shape?this._shape=DvtSimpleMarker.RECTANGLE:"plus"==b.shape?this._shape=DvtSimpleMarker.PLUS:"diamond"==b.shape?this._shape=DvtSimpleMarker.DIAMOND:"triangleUp"==b.shape?this._shape=DvtSimpleMarker.TRIANGLE_UP:"triangleDown"==b.shape&&(this._shape=DvtSimpleMarker.TRIANGLE_DOWN);
this._desc=b.desc;this._color=b.color;this._gradient=b.gradient;null!=b.opacity&&(this._opacity=parseFloat(b.opacity));null!=b.scaleX&&(this._scaleX=parseFloat(b.scaleX));null!=b.scaleY&&(this._scaleY=parseFloat(b.scaleY));null!=b.durationFillColor&&(this._durationFillColor=b.durationFillColor)};DvtTimelineOverviewNode.prototype.getId=function(){return this._id};DvtTimelineOverviewNode.prototype.getRowKey=function(){return this._rowKey};DvtTimelineOverviewNode.prototype.getTime=function(){return this._time};
DvtTimelineOverviewNode.prototype.getEndTime=function(){return this._endTime};DvtTimelineOverviewNode.prototype.getScaleX=function(){return this._scaleX};DvtTimelineOverviewNode.prototype.getScaleY=function(){return this._scaleY};DvtTimelineOverviewNode.prototype.getDescription=function(){return this._desc};DvtTimelineOverviewNode.prototype.getColor=function(){return this._color};DvtTimelineOverviewNode.prototype.isGradient=function(){return this._gradient};
DvtTimelineOverviewNode.prototype.getShape=function(){return this._shape};DvtTimelineOverviewNode.prototype.getOpacity=function(){return this._opacity};DvtTimelineOverviewNode.prototype.getDisplayable=function(){return this._displayable};DvtTimelineOverviewNode.prototype.setDisplayable=function(a){this._displayable=a};DvtTimelineOverviewNode.prototype.getX=function(){return this._x};DvtTimelineOverviewNode.prototype.setX=function(a){this._x=a};DvtTimelineOverviewNode.prototype.getY=function(){return this._y};
DvtTimelineOverviewNode.prototype.setY=function(a){this._y=a};var DvtTimelineOverviewEvent=function(a){this.Init(DvtTimelineOverviewEvent.TYPE);this._subtype=a};DvtObj.createSubclass(DvtTimelineOverviewEvent,DvtOverviewEvent,"DvtTimelineOverviewEvent");DvtTimelineOverviewEvent.TYPE="timeline";DvtTimelineOverviewEvent.SUBTYPE_HIGHLIGHT="highlight";DvtTimelineOverviewEvent.SUBTYPE_UNHIGHLIGHT="unhighlight";DvtTimelineOverviewEvent.SUBTYPE_SELECTION="selection";
DvtTimelineOverviewEvent.SUBTYPE_SCROLL_TIME=DvtOverviewEvent.SUBTYPE_SCROLL_TIME;DvtTimelineOverviewEvent.SUBTYPE_SCROLL_POS=DvtOverviewEvent.SUBTYPE_SCROLL_POS;DvtTimelineOverviewEvent.SUBTYPE_RANGECHANGE=DvtOverviewEvent.SUBTYPE_RANGECHANGE;DvtTimelineOverviewEvent.SUBTYPE_RANGECHANGING="rangeChanging";DvtTimelineOverviewEvent.SUBTYPE_DROPCALLBACK=DvtOverviewEvent.SUBTYPE_PRE_RANGECHANGE;DvtTimelineOverviewEvent.ITEM_ID_KEY="itemId";DvtTimelineOverviewEvent.MULTI_SELECT_KEY="multiSelect";
DvtTimelineOverviewEvent.START_POS=DvtOverviewEvent.START_POS;DvtTimelineOverviewEvent.END_POS=DvtOverviewEvent.END_POS;DvtTimelineOverviewEvent.prototype.setItemId=function(a){this.addParam(DvtTimelineOverviewEvent.ITEM_ID_KEY,a)};DvtTimelineOverviewEvent.prototype.getItemId=function(){return this.getParamValue(DvtTimelineOverviewEvent.ITEM_ID_KEY)};DvtTimelineOverviewEvent.prototype.setMultiSelect=function(a){this.addParam(DvtTimelineOverviewEvent.MULTI_SELECT_KEY,a)};
DvtTimelineOverviewEvent.prototype.isMultiSelect=function(){var a=this.getParamValue(DvtTimelineOverviewEvent.MULTI_SELECT_KEY);return null!=a?a:!1};var DvtTimelineOverviewAutomation=function(a){this._Init(a)};DvtObj.createSubclass(DvtTimelineOverviewAutomation,DvtAutomation,"DvtTimelineOverviewAutomation");DvtTimelineOverviewAutomation.prototype._Init=function(a){this._overview=a};DvtTimelineOverviewAutomation.NODE_ID_PREFIX="marker";DvtTimelineOverviewAutomation.WINDOW_ID="range_window";
DvtTimelineOverviewAutomation.START_HANDLE_ID="range_start_handle";DvtTimelineOverviewAutomation.END_HANDLE_ID="range_end_handle";DvtTimelineOverviewAutomation.AUTOMATION_NO_EVENT=-1;DvtTimelineOverviewAutomation.AUTOMATION_MOUSE_CLICK=0;
DvtTimelineOverviewAutomation.prototype.GetSubIdForDomElement=function(a){var b=a.getId();if(a instanceof DvtSimpleMarker){a=b.split(":");if(4!=a.length)return null;b=this._overview.getSeriesIds();if(null!=b&&(b=b.indexOf(a[1]),-1<b))return"marker["+b+"]["+a[2]+"]"}else{if("window"==b)return DvtTimelineOverviewAutomation.WINDOW_ID;if("lh"==b||"lhb"==b||"lbgrh"==b)return DvtTimelineOverviewAutomation.START_HANDLE_ID;if("rh"==b||"rhb"==b||"rbgrh"==b)return DvtTimelineOverviewAutomation.END_HANDLE_ID;
if("grpy"==b)return a=a.getParent().getChildBefore(a),this.GetSubIdForDomElement(a)}return null};
DvtTimelineOverviewAutomation.prototype.getDomElementForSubId=function(a){var b=DvtTimelineOverviewAutomation._convertSubIdToArray(a);if(b&&3==b.length&&b[0]==DvtTimelineOverviewAutomation.NODE_ID_PREFIX){if(a=this._overview.getSeriesIds(),null!=a){var c=parseInt(b[1],10);if(-1<c&&c<a.length)return(b=DvtTimelineOverviewAutomation._findMarker(this._overview.getMarkers(),a[c],b[2]))?b.getDisplayable().getElem():null}}else{if(a==DvtTimelineOverviewAutomation.WINDOW_ID)return this._overview.getSlidingWindow().getElem();
if(a==DvtTimelineOverviewAutomation.START_HANDLE_ID)return this._overview.getLeftHandle().getElem();if(a==DvtTimelineOverviewAutomation.END_HANDLE_ID)return this._overview.getRightHandle().getElem()}return null};DvtTimelineOverviewAutomation.prototype.click=function(a){this.processSubId(a,DvtTimelineOverviewAutomation.AUTOMATION_MOUSE_CLICK)};
DvtTimelineOverviewAutomation.prototype.processSubId=function(a,b){void 0===b&&(b=DvtTimelineOverviewAutomation.AUTOMATION_NO_EVENT);if(null!=a&&b!=DvtTimelineOverviewAutomation.AUTOMATION_NO_EVENT&&b==DvtTimelineOverviewAutomation.AUTOMATION_MOUSE_CLICK){var c=DvtTimelineOverviewAutomation._convertSubIdToArray(a);c&&3==c.length&&c[0]==DvtTimelineOverviewAutomation.NODE_ID_PREFIX&&(c=DvtTimelineOverviewAutomation._findMarker(this._overview.getMarkers(),c[1],c[2]))&&this._overview.HandleMarkerClick(c.getDisplayable(),
!1)}};DvtTimelineOverviewAutomation._convertSubIdToArray=function(a){a=a.split("[");for(var b=a.length,c=1;c<b;c++){var d=a[c],d=d.substr(0,d.length-1),e=parseFloat(d),d=isNaN(e)?d:e;a[c]=d}return a};DvtTimelineOverviewAutomation._findMarker=function(a,b,c){b="tl1:"+b+":"+c+":";for(c=0;c<a.length;c++){var d=a[c],e=d.getId();if(null!=e&&0==e.indexOf(b))return d}return null};